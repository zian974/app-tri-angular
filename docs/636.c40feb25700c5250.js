"use strict";(self.webpackChunkapp_base=self.webpackChunkapp_base||[]).push([[636],{5636:(be,k,a)=>{a.r(k),a.d(k,{TrisModule:()=>he});var m=a(9808),g=a(4638),o=a(4182),f=a(5529),Y=a(2868),h=a(537),p=a(1715),T=a(4483);class M{constructor(n){this.fb=n,this.data={triFruitsEtat:[{lbl:"mature",value:"M",checked:!1},{lbl:"immature",value:"I",checked:!1}],triGrainesEtat:[{lbl:"Bon",value:"B",checked:!1},{lbl:"Moyen",value:"M",checked:!1},{lbl:"Mauvais",value:"N",checked:!1}]},this.fgObject={id:[null,[o.kI.pattern("[0-9]*")]],cd_ref:[null,[o.kI.pattern("[0-9]*")]],nom_botanique:["",[o.kI.required]],num_accession:["",[o.kI.required,o.kI.pattern("^(WS|WV|CS|CV|BS) [0-9]+-[0-9]*$")]],tri_date:[null,[o.kI.required,o.kI.pattern("([0-9]{4}-[0-9]{2}-[0-9]{2}(.*))?")]],tri_duree:[null,[o.kI.required,o.kI.pattern("[0-9]{2}:[0-9][05]")]],tri_origin:[null,[o.kI.required]],tri_origin_other:[null,[]],agents:[[],[o.kI.required]],fruits_etat:new o.Oe([]),fruits_pds:[null,[o.kI.required,o.kI.pattern("[0-9]*.[0-9]{3,4}")]],fruits_nb:[null,[o.kI.required,o.kI.pattern("[0-9]*")]],graines_pds:[null,[o.kI.required,o.kI.pattern("[0-9]*.[0-9]{3,4}")]],graines_100pds:[null,[o.kI.pattern("[0-9]*.[0-9]{3,4}")]],graines_1000pds:[null,[o.kI.pattern("[0-9]*.[0-9]{3,4}")]],graines_nb:[null,[o.kI.required,o.kI.pattern("[0-9]*")]],graines_nb_estime:[null,[o.kI.required,o.kI.pattern("[0-9]*")]],graines_etat:new o.Oe([]),graines_trash_pds:[null,[o.kI.required,o.kI.pattern("[0-9]*.[0-9]{3,4}")]],graines_trash_nb:[null,[o.kI.required,o.kI.pattern("[0-9]*")]],graines_trash_raison:[null,[]]},this.updateValidators=e=>{null!==e&&this.fg.updateValueAndValidity()},this.fg=this.fb.group(this.fgObject)}patchValue(n){var e;for(let[i,s]of Object.entries(n))if(this.fg.get(i)){if("tri_date"==i&&null!==s&&(s=(0,m.p6)(s,"yyyy-MM-dd","fr-FR")),"agents"==i&&null!==s){let l=[];s.forEach(u=>{l.push(u.id)}),this.agents.setValue(l);continue}if("fruits_etat"==i){s.split(",").map((u,d)=>{let c=this.data.triFruitsEtat.findIndex(_=>_.value===u);-1!==c&&(this.data.triFruitsEtat[c].checked=!0),this.fruits_etat.push(new o.NI(u))});continue}if("graines_etat"==i){s.split(",").map((u,d)=>{let c=this.data.triGrainesEtat.findIndex(_=>_.value===u);-1!==c&&(this.data.triGrainesEtat[c].checked=!0),this.graines_etat.push(new o.NI(u))});continue}null===(e=this.fg.get(i))||void 0===e||e.setValue(s)}}get id(){return this.fg.get("id")}get cd_ref(){return this.fg.get("cd_ref")}get nom_botanique(){return this.fg.get("nom_botanique")}get num_accession(){return this.fg.get("num_accession")}get tri_date(){return this.fg.get("tri_date")}get tri_duree(){return this.fg.get("tri_duree")}get tri_origin(){return this.fg.get("tri_origin")}get tri_origin_other(){return this.fg.get("tri_origin_other")}get fruits_etat(){return this.fg.get("fruits_etat")}get fruits_pds(){return this.fg.get("fruits_pds")}get fruits_nb(){return this.fg.get("fruits_nb")}get graines_etat(){return this.fg.get("graines_etat")}get graines_pds(){return this.fg.get("graines_pds")}get graines_100pds(){return this.fg.get("graines_100pds")}get graines_1000pds(){return this.fg.get("graines_1000pds")}get graines_nb(){return this.fg.get("graines_nb")}get graines_nb_estime(){return this.fg.get("graines_nb_estime")}get graines_trash_pds(){return this.fg.get("graines_trash_pds")}get graines_trash_nb(){return this.fg.get("graines_trash_nb")}get graines_trash_raison(){return this.fg.get("graines_trash_raison")}get agents(){return this.fg.get("agents")}}class E{constructor(n){this.cd_ref=null,this.tri_comment="",this.graines_100pds=null,this.graines_1000pds=null,this.graines_nb_estime=null,this.graines_trash_pds=null,this.graines_trash_nb=null,this.graines_trash_raison=null,this.agents=[],Object.assign(this,n)}}var t=a(2096),v=a(7221),V=a(2362),C=a(4600),b=a(2340),x=a(520);let N=(()=>{class r extends V.e{constructor(e){super(),this.http=e,this.index=i=>{let s=(0,C._)(i);return this.http.get(b.N.apiUrl+"/api/tris?"+s).pipe((0,v.K)(this.handleError()))},this.get=i=>this.http.get(b.N.apiUrl+"/api/tris/"+i).pipe((0,v.K)(this.handleError())),this.store=i=>{const s=i.id?this.http.put(b.N.apiUrl+"/api/tris/"+i.id,i):this.http.post(b.N.apiUrl+"/api/tris",i);return this.httpStart$.next(),s.pipe((0,v.K)(this.handleError()),(0,h.x)(()=>{this.httpEnd$.next()}))}}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(x.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var q=a(7625),D=a(3489),L=a(6686);const $=new(a(2268).v)(L.o);function I(r,n=$){return e=>e.lift(new j(r,n))}class j{constructor(n,e){this.dueTime=n,this.scheduler=e}call(n,e){return e.subscribe(new z(n,this.dueTime,this.scheduler))}}class z extends D.L{constructor(n,e,i){super(n),this.dueTime=e,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(n){this.clearDebounce(),this.lastValue=n,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(P,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:n}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(n)}}clearDebounce(){const n=this.debouncedSubscription;null!==n&&(this.remove(n),n.unsubscribe(),this.debouncedSubscription=null)}}function P(r){r.debouncedNext()}var U=a(5778),J=a(2198),S=a(7545),w=a(1737);let O=(()=>{class r{constructor(e){this.http=e,this.autocomplete=(i=null)=>{let s=(0,C._)(i),l="https://taxref.mnhn.fr/api/taxa/autocomplete";return l=s?l+"?"+s:l,this.http.get(l).pipe((0,v.K)(this.handleError()))},this.handleError=()=>i=>(0,w._)(i)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(x.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac}),r})();const B=["agentsForm"];function G(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12),t._uU(2),t.qZA(),t.TgZ(3,"button",13),t.NdJ("click",function(){return t.CHM(e),t.oxw().onRemove()}),t.TgZ(4,"span",14),t._uU(5," close "),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(2),t.hij("",e.data.selectedTaxon.scientificName," ")}}function H(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).onClick(l)}),t.TgZ(1,"div",19)(2,"div",20)(3,"h5",21),t._uU(4),t.qZA(),t.TgZ(5,"p",22),t._uU(6),t.qZA(),t._UZ(7,"small",23),t.qZA()()()}if(2&r){const e=n.$implicit;t.xp6(4),t.Oqu(e.scientificName),t.xp6(2),t.hij(" ",e.scientificName," ")}}function K(r,n){if(1&r&&(t.TgZ(0,"div",15)(1,"div",16),t.YNc(2,H,8,2,"div",17),t.qZA()()),2&r){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.data.Taxa)("ngForTrackBy",e.trackBy)}}let X=(()=>{class r{constructor(e,i,s,l,u){this._elementRef=e,this.taxrefSvc=i,this.cdRef=s,this.element=l,this.renderer=u,this.taxonSelected=new t.vpe,this.data={Taxa:[],selectedTaxon:new p.N,states:{listVisible:!1},filters:{term:"",size:25}},this.onComponentDestroy$=new f.xQ,this.trackBy=(d,c)=>c.id,this.onClick=d=>{this.data.selectedTaxon=new p.N(d),this.data.filters.term="",this.toggleList(),this.taxonSelected.next(this.data.selectedTaxon)},this.onRemove=()=>{this.data.selectedTaxon=new p.N}}set selectedTaxon(e){this.data.selectedTaxon=new p.N(e),this.cdRef.markForCheck()}ngOnInit(){}ngAfterViewInit(){this.formChangesSubscription$=this.ngForm.form.valueChanges.pipe((0,q.R)(this.onComponentDestroy$),I(300),(0,U.x)(),(0,J.h)(e=>e.term&&e.term.length>=3),(0,S.w)(e=>{var i;return null===(i=this._elementRef.nativeElement.querySelector(".spinner"))||void 0===i||i.classList.add("show"),this.taxrefSvc.autocomplete(e).pipe((0,h.x)(()=>{var s;return null===(s=this._elementRef.nativeElement.querySelector(".spinner"))||void 0===s?void 0:s.classList.remove("show")}))})),this.formChangesSubscription$.subscribe({next:e=>{e._embedded&&e._embedded.taxa.length>0&&(this.data.Taxa=[...e._embedded.taxa],this.data.states.listVisible=!0),this.cdRef.markForCheck()},error:e=>{console.log(e)}}),this.unlistenDocumentClick$=this.renderer.listen(document,"click",e=>{this.onClickOutside(e)}),this.cdRef.markForCheck()}ngOnDestroy(){this.onComponentDestroy$.next(),this.onComponentDestroy$.complete()}onClickOutside(e){this.element.nativeElement.querySelector(".TaxaFilterContainer")&&!this.element.nativeElement.querySelector(".TaxaFilterContainer").contains(e.target)&&this.toggleList(e)}toggleList(e=null){this.data.states.listVisible=!this.data.states.listVisible,this.cdRef.markForCheck(),null==e||e.stopPropagation()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(t.SBq),t.Y36(O),t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(t.Qsj))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-taxref"]],viewQuery:function(e,i){if(1&e&&t.Gf(B,5),2&e){let s;t.iGM(s=t.CRH())&&(i.ngForm=s.first)}},inputs:{formInput:"formInput",multiple:"multiple",selectedTaxon:"selectedTaxon"},outputs:{taxonSelected:"taxonSelected"},decls:12,vars:5,consts:[["class","row align-items-center",4,"ngIf"],[3,"hidden"],[2,"position","relative"],["agentsForm","ngForm"],["type","hidden","id","size","name","size",3,"ngModel","ngModelChange"],[1,"input-group","mb-2"],["type","text","id","term","name","term","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-text","spinner"],["role","status",1,"spinner-border","spinner-border-sm","fader","text-primary","d-inline-block"],[1,"visually-hidden"],["class","card TaxaFilterContainer","style","position: absolute; inset: 0px 0 auto 0; transform: translate(0px, 42px); z-index: 99;",4,"ngIf"],[1,"row","align-items-center"],[1,"lead","col"],[1,"btn","btn-outline-black","col-auto",2,"--bs-btn-padding-y",".25rem","--bs-btn-padding-x",".5rem","--bs-btn-font-size",".75rem",3,"click"],["_ngcontent-ggo-c50","",1,"material-symbols-outlined",2,"font-size","1rem"],[1,"card","TaxaFilterContainer",2,"position","absolute","inset","0px 0 auto 0","transform","translate(0px, 42px)","z-index","99"],[1,"list-group","my-n3"],["class","list-group-item",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"list-group-item",3,"click"],[1,"row"],[1,"col","ms-n2"],[1,"mb-1"],[1,"small","text-gray-700","mb-0"],[1,"text-muted"]],template:function(e,i){1&e&&(t.YNc(0,G,6,1,"div",0),t.TgZ(1,"div",1)(2,"form",2,3)(4,"input",4),t.NdJ("ngModelChange",function(l){return i.data.filters.size=l}),t.qZA(),t.TgZ(5,"div",5)(6,"input",6),t.NdJ("ngModelChange",function(l){return i.data.filters.term=l}),t.qZA(),t.TgZ(7,"span",7)(8,"div",8)(9,"span",9),t._uU(10,"Loading..."),t.qZA()()()(),t.YNc(11,K,3,2,"div",10),t.qZA()()),2&e&&(t.Q6J("ngIf",i.data.selectedTaxon.scientificName),t.xp6(1),t.Q6J("hidden",i.data.selectedTaxon.scientificName),t.xp6(3),t.Q6J("ngModel",i.data.filters.size),t.xp6(2),t.Q6J("ngModel",i.data.filters.term),t.xp6(5),t.Q6J("ngIf",i.data.states.listVisible))},directives:[m.O5,o._Y,o.JL,o.F,o.Fj,o.JJ,o.On,o.Q7,m.sg],styles:[".list-group-item[_ngcontent-%COMP%]{cursor:pointer}",".spinner[_ngcontent-%COMP%]{display:none}",".spinner.show[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),r})(),W=(()=>{class r{constructor(e){this.http=e,this.index=(i=null)=>{let s=(0,C._)(i),l=b.N.apiUrl+"/api/agents";return l=s?l+"?"+s:l,this.http.get(l).pipe((0,v.K)(this.handleError()))},this.handleError=()=>i=>(0,w._)(i)}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(x.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const tt=["agentsForm"];function et(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",12),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).onClick(l)}),t.TgZ(1,"div",13)(2,"div",14)(3,"h5",15),t._uU(4),t.qZA(),t.TgZ(5,"p",16),t._uU(6),t.qZA(),t.TgZ(7,"small",17),t._uU(8),t.qZA()()()()}if(2&r){const e=n.$implicit;t.xp6(4),t.Oqu(e.abbr),t.xp6(2),t.AsE(" ",e.nom," ",e.prenom," "),t.xp6(2),t.hij(" ",e.email," ")}}function it(r,n){if(1&r&&(t.TgZ(0,"div",9)(1,"div",10),t.YNc(2,et,9,4,"div",11),t.qZA()()),2&r){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.data.agents)("ngForTrackBy",e.trackBy)}}function rt(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"li",18)(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div")(4,"button",19),t.NdJ("click",function(){const l=t.CHM(e).index;return t.oxw().onRemove(l)}),t.TgZ(5,"span",20),t._uU(6," close "),t.qZA()()()()}if(2&r){const e=n.$implicit;t.xp6(2),t.lnq("",e.abbr," - ",e.nom," ",e.prenom,"")}}let nt=(()=>{class r{constructor(e,i,s,l,u){this.agentsSvc=e,this._elementRef=i,this.cdRef=s,this.element=l,this.renderer=u,this.data={agents:[],selectedAgents:[],states:{listVisible:!1},filters:{abbr:""}},this.onComponentDestroy$=new f.xQ,this.trackBy=(d,c)=>c.id,this.onClick=d=>{this.formInput.value.includes(d.id)||(this.formInput.value.push(d.id),this.data.selectedAgents.push(d),this.formInput.updateValueAndValidity()),this.data.filters.abbr="",this.toggleList()},this.onRemove=d=>{let c=this.data.selectedAgents[d].id,_=this.formInput.value;_=_.filter(ve=>ve!==c),this.formInput.setValue(_),this.data.selectedAgents.splice(d,1),this.formInput.markAsDirty()}}set selectedAgents(e){this.data.selectedAgents=[...e],this.cdRef.markForCheck()}ngOnInit(){}ngAfterViewInit(){this.formChangesSubscription$=this.ngForm.form.valueChanges.pipe((0,q.R)(this.onComponentDestroy$),I(300),(0,U.x)(),(0,J.h)(e=>e.abbr&&e.abbr.length>=3),(0,S.w)(e=>{var i;return null===(i=this._elementRef.nativeElement.querySelector(".spinner"))||void 0===i||i.classList.add("show"),this.agentsSvc.index(e).pipe((0,h.x)(()=>{var s;return null===(s=this._elementRef.nativeElement.querySelector(".spinner"))||void 0===s?void 0:s.classList.remove("show")}))})),this.formChangesSubscription$.subscribe(e=>{e.items&&e.items.length>0&&(this.data.agents=[...e.items],this.data.states.listVisible=!0),this.cdRef.markForCheck()}),this.unlistenDocumentClick$=this.renderer.listen(document,"click",e=>{this.onClickOutside(e)}),this.cdRef.markForCheck()}ngOnDestroy(){this.onComponentDestroy$.next(),this.onComponentDestroy$.complete()}onClickOutside(e){this.element.nativeElement.querySelector(".agentsFilterContainer")&&!this.element.nativeElement.querySelector(".agentsFilterContainer").contains(e.target)&&this.toggleList(e)}toggleList(e=null){this.data.states.listVisible=!this.data.states.listVisible,this.cdRef.markForCheck(),null==e||e.stopPropagation()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(W),t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(t.Qsj))},r.\u0275cmp=t.Xpm({type:r,selectors:[["agents-select"]],viewQuery:function(e,i){if(1&e&&t.Gf(tt,5),2&e){let s;t.iGM(s=t.CRH())&&(i.ngForm=s.first)}},inputs:{formInput:"formInput",multiple:"multiple",selectedAgents:"selectedAgents"},decls:11,vars:3,consts:[["agentsForm","ngForm"],[1,"input-group","mb-2"],["type","text","id","abbr","name","abbr",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-text","spinner"],["role","status",1,"spinner-border","spinner-border-sm","fader","text-primary","d-inline-block"],[1,"visually-hidden"],["class","card agentsFilterContainer",4,"ngIf"],[1,"list-group","list-group-lg"],["class","list-group-item  d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"card","agentsFilterContainer"],[1,"list-group","my-n3"],["class","list-group-item",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"list-group-item",3,"click"],[1,"row"],[1,"col","ms-n2"],[1,"mb-1"],[1,"small","text-gray-700","mb-0"],[1,"text-muted"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-outline",2,"--bs-btn-padding-y",".25rem","--bs-btn-padding-x",".5rem","--bs-btn-font-size",".75rem",3,"click"],["_ngcontent-ggo-c50","",1,"material-symbols-outlined",2,"font-size","1rem"]],template:function(e,i){1&e&&(t.TgZ(0,"form",null,0)(2,"div",1)(3,"input",2),t.NdJ("ngModelChange",function(l){return i.data.filters.abbr=l}),t.qZA(),t.TgZ(4,"span",3)(5,"div",4)(6,"span",5),t._uU(7,"Loading..."),t.qZA()()()(),t.YNc(8,it,3,2,"div",6),t.qZA(),t.TgZ(9,"ul",7),t.YNc(10,rt,7,3,"li",8),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngModel",i.data.filters.abbr),t.xp6(5),t.Q6J("ngIf",i.data.states.listVisible),t.xp6(2),t.Q6J("ngForOf",i.data.selectedAgents))},directives:[o._Y,o.JL,o.F,o.Fj,o.JJ,o.On,m.O5,m.sg],styles:["[_nghost-%COMP%]{display:block}","[_nghost-%COMP%] > form[_ngcontent-%COMP%]{position:relative;z-index:1}",".agentsFilterContainer[_ngcontent-%COMP%]{position:absolute;inset:0px 0 auto 0;transform:translateY(42px)}",".spinner[_ngcontent-%COMP%]{display:none}",".spinner.show[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),r})();function st(r,n){1&r&&(t.ynx(0),t._uU(1," Fiche "),t.BQk())}function ot(r,n){1&r&&t._uU(0," Nouveau ")}function lt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner un nom botanique "),t.qZA())}function at(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,lt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.nom_botanique||null==e.triForm.nom_botanique.errors?null:e.triForm.nom_botanique.errors.required)}}function ut(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner un num\xe9ro d'accession "),t.qZA())}function dt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le num\xe9ro d'accession est invalide "),t.qZA())}function mt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,ut,2,0,"div",76),t.YNc(2,dt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.num_accession||null==e.triForm.num_accession.errors?null:e.triForm.num_accession.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.num_accession||null==e.triForm.num_accession.errors?null:e.triForm.num_accession.errors.pattern)}}function ct(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une date "),t.qZA())}function _t(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,ct,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.tri_date||null==e.triForm.tri_date.errors?null:e.triForm.tri_date.errors.required)}}function gt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner au minimum 1 agent "),t.qZA())}function pt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,gt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.agents||null==e.triForm.agents.errors?null:e.triForm.agents.errors.required)}}function ft(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez s\xe9lectionner une origine "),t.qZA())}function ht(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,ft,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.tri_origin||null==e.triForm.tri_origin.errors?null:e.triForm.tri_origin.errors.required)}}function vt(r,n){1&r&&t._UZ(0,"input",77)}function bt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir une origine "),t.qZA())}function Tt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,bt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.tri_origin_other||null==e.triForm.tri_origin_other.errors?null:e.triForm.tri_origin_other.errors.required)}}function Ft(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner un poids "),t.qZA())}function Zt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le poids indiqu\xe9 est invalide "),t.qZA())}function Ct(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,Ft,2,0,"div",76),t.YNc(2,Zt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.fruits_pds||null==e.triForm.fruits_pds.errors?null:e.triForm.fruits_pds.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.fruits_pds||null==e.triForm.fruits_pds.errors?null:e.triForm.fruits_pds.errors.pattern)}}function xt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une quantit\xe9 "),t.qZA())}function qt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," La quantit\xe9 indiqu\xe9e est invalide "),t.qZA())}function At(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,xt,2,0,"div",76),t.YNc(2,qt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.fruits_nb||null==e.triForm.fruits_nb.errors?null:e.triForm.fruits_nb.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.fruits_nb||null==e.triForm.fruits_nb.errors?null:e.triForm.fruits_nb.errors.pattern)}}function yt(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",78)(1,"input",79),t.NdJ("change",function(s){return t.CHM(e),t.oxw().onFruitsEtatChange(s)}),t.qZA(),t.TgZ(2,"label",80),t._uU(3),t.qZA()()}if(2&r){const e=n.$implicit,i=n.index;t.xp6(1),t.MGl("id","check-mature",i,""),t.Q6J("value",e.value)("checked",e.checked),t.xp6(1),t.MGl("for","check-mature",i,""),t.xp6(1),t.hij(" ",e.lbl," ")}}function kt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner un poids "),t.qZA())}function Et(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le poids indiqu\xe9 est invalide "),t.qZA())}function Nt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,kt,2,0,"div",76),t.YNc(2,Et,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_pds||null==e.triForm.graines_pds.errors?null:e.triForm.graines_pds.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_pds||null==e.triForm.graines_pds.errors?null:e.triForm.graines_pds.errors.pattern)}}function It(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le poids indiqu\xe9 est invalide "),t.qZA())}function Ut(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,It,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_100pds||null==e.triForm.graines_100pds.errors?null:e.triForm.graines_100pds.errors.pattern)}}function Jt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le poids indiqu\xe9 est invalide "),t.qZA())}function St(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,Jt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_1000pds||null==e.triForm.graines_1000pds.errors?null:e.triForm.graines_1000pds.errors.pattern)}}function wt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une quantit\xe9 "),t.qZA())}function Ot(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," La quantit\xe9 indiqu\xe9e est invalide "),t.qZA())}function Qt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,wt,2,0,"div",76),t.YNc(2,Ot,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_nb_estime||null==e.triForm.graines_nb_estime.errors?null:e.triForm.graines_nb_estime.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_nb_estime||null==e.triForm.graines_nb_estime.errors?null:e.triForm.graines_nb_estime.errors.pattern)}}function Yt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une quantit\xe9 "),t.qZA())}function Mt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," La quantit\xe9 indiqu\xe9e est invalide "),t.qZA())}function Vt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,Yt,2,0,"div",76),t.YNc(2,Mt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_nb||null==e.triForm.graines_nb.errors?null:e.triForm.graines_nb.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_nb||null==e.triForm.graines_nb.errors?null:e.triForm.graines_nb.errors.pattern)}}function Dt(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",78)(1,"input",81),t.NdJ("change",function(s){return t.CHM(e),t.oxw().onGrainesEtatChange(s)}),t.qZA(),t.TgZ(2,"label",80),t._uU(3),t.qZA()()}if(2&r){const e=n.$implicit,i=n.index;t.xp6(1),t.MGl("id","radio-etat",i,""),t.Q6J("value",e.value)("checked",e.checked),t.xp6(1),t.MGl("for","radio-etat",i,""),t.xp6(1),t.hij(" ",e.lbl," ")}}function Lt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner un poids "),t.qZA())}function Rt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Le poids indiqu\xe9 est invalide "),t.qZA())}function $t(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,Lt,2,0,"div",76),t.YNc(2,Rt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_trash_pds||null==e.triForm.graines_trash_pds.errors?null:e.triForm.graines_trash_pds.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_trash_pds||null==e.triForm.graines_trash_pds.errors?null:e.triForm.graines_trash_pds.errors.pattern)}}function jt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une quantit\xe9 "),t.qZA())}function zt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," La quantit\xe9 indiqu\xe9e est invalide "),t.qZA())}function Pt(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,jt,2,0,"div",76),t.YNc(2,zt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_nb||null==e.triForm.graines_nb.errors?null:e.triForm.graines_nb.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.graines_trash_nb||null==e.triForm.graines_trash_nb.errors?null:e.triForm.graines_trash_nb.errors.pattern)}}function Bt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," Veuillez saisir/s\xe9lectionner une dur\xe9e "),t.qZA())}function Gt(r,n){1&r&&(t.TgZ(0,"div"),t._uU(1," La dur\xe9e indiqu\xe9e est invalide "),t.qZA())}function Ht(r,n){if(1&r&&(t.TgZ(0,"div",75),t.YNc(1,Bt,2,0,"div",76),t.YNc(2,Gt,2,0,"div",76),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",null==e.triForm.tri_duree||null==e.triForm.tri_duree.errors?null:e.triForm.tri_duree.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.triForm.tri_duree||null==e.triForm.tri_duree.errors?null:e.triForm.tri_duree.errors.pattern)}}const Kt=function(){return["/tris"]};let Xt=(()=>{class r{constructor(e,i,s,l){this.cdRef=e,this.fb=i,this.route=s,this.triSvc=l,this.onComponentDestroy$=new f.xQ,this.data={tri:new E,selectedTaxon:new p.N},this.triForm=new M(this.fb),this.fg=this.triForm.fg,this.getItem=u=>{this.triSvc.get(u).subscribe(d=>{this.data.tri=new E(Object.assign({},d)),this.triForm.patchValue(d),this.data.selectedTaxon=new p.N({referenceId:this.data.tri.cd_ref,scientificName:this.data.tri.nom_botanique}),this.cdRef.markForCheck()})}}ngOnInit(){const e=parseInt(this.route.snapshot.paramMap.get("id"));e&&this.getItem(e),this.triForm.tri_origin.valueChanges.pipe((0,Y.b)(i=>{"other"===i?this.triForm.tri_origin_other.setValidators(o.kI.required):(this.triForm.tri_origin_other.clearValidators(),this.triForm.tri_origin_other.reset()),this.triForm.tri_origin_other.updateValueAndValidity()})).subscribe()}ngOnDestroy(){this.onComponentDestroy$.next(),this.onComponentDestroy$.complete()}deleteItem(){}submitItem(){if("VALID"===this.triForm.fg.status)this.spinner.show(),this.triSvc.store(this.triForm.fg.value).pipe((0,h.x)(()=>{this.spinner.hide()})).subscribe(e=>{this.triForm.patchValue(e)});else{let e=this.triForm.fg.controls;for(let i in e)e[i].markAsDirty(),"VALID"!==e[i].status&&console.log(i,e[i].errors)}}onTaxonSelect(e){this.triForm.nom_botanique.setValue(e.scientificName),this.triForm.cd_ref.setValue(e.referenceId)}onFruitsEtatChange(e){if(e.target.checked)this.triForm.fruits_etat.push(new o.NI(e.target.value));else{const i=this.triForm.fruits_etat.controls.findIndex(s=>s.value===e.target.value);-1!==i&&this.triForm.fruits_etat.removeAt(i)}}onGrainesEtatChange(e){this.triForm.graines_etat.controls.splice(0,1),this.triForm.graines_etat.push(new o.NI(e.target.value))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(t.sBO),t.Y36(o.qu),t.Y36(g.gz),t.Y36(N))},r.\u0275cmp=t.Xpm({type:r,selectors:[["tri-edit"]],viewQuery:function(e,i){if(1&e&&t.Gf(T.O,5),2&e){let s;t.iGM(s=t.CRH())&&(i.spinner=s.first)}},decls:149,vars:28,consts:[["aria-label","breadcrumb"],[1,"breadcrumb","text-upper-small"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"header"],[1,"header-body"],[1,"row","align-items-center"],[1,"col"],[1,"header-title","text-truncate"],[4,"ngIf","ngIfElse"],["newTri",""],[1,"col-auto"],["type","button","label","Delete",1,"btn","btn-danger","ms-2","d-flex",3,"disabled","click"],[1,"material-symbols-outlined"],[1,"card"],[1,"card-body"],["name","stagiaireForm",3,"formGroup","ngSubmit"],[1,"text-required"],[1,"text-muted"],[1,"text-danger"],[1,"col-md-6"],[1,"form-group","mb-3"],["for","nom_botanique",1,"form-label","required"],[3,"selectedTaxon","taxonSelected"],["type","hidden","id","nom_botanique","formControlName","nom_botanique","required",""],["class","invalid-feedback d-block",4,"ngIf"],[1,"form-group","col-md-6","g-0","mb-3"],["for","num_accession",1,"form-label","required"],["type","text","id","num_accession","placeholder","WS 22-1","formControlName","num_accession","required","",1,"form-control"],["for","tri_date",1,"form-label","required"],["type","date","pattern","^(\\d{4}-\\d{2}-\\d{2}(.*))?","id","tri_date","formControlName","tri_date","required","",1,"form-control"],["for","agents",1,"form-label","required"],["type","hidden","minlength","1","formControlName","agents","required",""],[3,"formInput","selectedAgents"],["for","tri_origin",1,"form-label","required"],["id","tri_origin","name","tri_origin","aria-label","Origine du lot \xe0 trier","formControlName","tri_origin","required","",1,"form-select"],["value","terrain"],["value","frigoES"],["value","frigoBN"],["value","other"],["type","text","class","form-control mt-2","id","tri_origin_other","name","tri_origin_other","formControlName","tri_origin_other",4,"ngIf"],[1,"row","col-md-6"],[1,"col-md-6","form-group","mb-3"],["for","fruits_pds",1,"form-label","required"],["type","number","step","0.0001","id","fruits_pds","name","fruits_pds","formControlName","fruits_pds","required","",1,"form-control"],["for","fruits_nb",1,"form-label","required"],["type","number","step","1","id","fruits_nb","formControlName","fruits_nb","required","",1,"form-control"],[1,"row"],[1,"col-md-4","form-group","mb-3"],["for","fruits_etat",1,"form-label","required"],[1,"d-flex"],["class","form-check d-inline-flex me-4",4,"ngFor","ngForOf"],[1,"col-md-3","form-group","mb-3"],["for","graines_pds",1,"form-label","required"],["type","number","step","0.0001","id","graines_pds","formControlName","graines_pds","required","",1,"form-control"],["for","graines_100pds",1,"form-label"],["type","number","step","0.0001","id","graines_100pds","formControlName","graines_100pds",1,"form-control"],["for","graines_1000pds",1,"form-label"],["type","number","step","0.0001","id","graines_1000pds","formControlName","graines_1000pds",1,"form-control"],["for","graines_nb_estime",1,"form-label","required"],["type","number","step","1","id","graines_nb_estime","formControlName","graines_nb_estime","required","",1,"form-control"],["for","graines_nb",1,"form-label","required"],["type","number","step","1","id","graines_nb","formControlName","graines_nb","required","",1,"form-control"],["for","graines_etat",1,"form-label"],["for","graines_trash_pds",1,"form-label"],["type","number","step","0.0001","id","graines_trash_pds","formControlName","graines_trash_pds",1,"form-control"],["for","graines_trash_nb",1,"form-label"],["type","number","step","1","id","graines_trash_nb","formControlName","graines_trash_nb",1,"form-control"],["for","graines_trash_raison",1,"form-label"],["rows","3","formControlName","graines_trash_raison",1,"form-control"],[1,"col-md-3"],["for","tri_duree",1,"form-label","required"],["type","text","id","tri_duree","placeholder","1:20","formControlName","tri_duree","required","",1,"form-control"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback","d-block"],[4,"ngIf"],["type","text","id","tri_origin_other","name","tri_origin_other","formControlName","tri_origin_other",1,"form-control","mt-2"],[1,"form-check","d-inline-flex","me-4"],["type","checkbox","formArrayName","fruits_etat",1,"form-check-input",3,"id","value","checked","change"],[1,"form-check-label","ms-1",3,"for"],["type","radio","name","radion-etat","formArrayName","graines_etat",1,"form-check-input",3,"id","value","checked","change"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._uU(4,"Tris"),t.qZA()(),t.TgZ(5,"li",4),t._uU(6,"Tri"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h1",9),t.YNc(12,st,2,0,"ng-container",10),t.YNc(13,ot,1,0,"ng-template",null,11,t.W1O),t.qZA()(),t.TgZ(15,"div",12)(16,"button",13),t.NdJ("click",function(){return i.deleteItem()}),t.TgZ(17,"span",14),t._uU(18," delete_forever "),t.qZA()()()()()(),t.TgZ(19,"div",15)(20,"div",16)(21,"form",17),t.NdJ("ngSubmit",function(){return i.submitItem()}),t.TgZ(22,"p",18)(23,"small",19),t._uU(24,"Les champs suivis d'un "),t.TgZ(25,"span",20),t._uU(26,"*"),t.qZA(),t._uU(27," sont obligatoires."),t.qZA()(),t.TgZ(28,"div",21)(29,"div",22)(30,"label",23),t._uU(31,"Nom botanique"),t.qZA(),t.TgZ(32,"app-taxref",24),t.NdJ("taxonSelected",function(l){return i.onTaxonSelect(l)}),t.qZA(),t._UZ(33,"input",25),t.YNc(34,at,2,1,"div",26),t.qZA(),t.TgZ(35,"div",27)(36,"label",28),t._uU(37,"Num\xe9ro d'accession"),t.qZA(),t._UZ(38,"input",29),t.YNc(39,mt,3,2,"div",26),t.qZA()(),t.TgZ(40,"div",21)(41,"div",22)(42,"label",30),t._uU(43,"Date de tri"),t.qZA(),t._UZ(44,"input",31),t.YNc(45,_t,2,1,"div",26),t.qZA(),t.TgZ(46,"div",22)(47,"label",32),t._uU(48,"Agent(s)"),t.qZA(),t._UZ(49,"input",33)(50,"agents-select",34),t.YNc(51,pt,2,1,"div",26),t.qZA(),t.TgZ(52,"div",22)(53,"label",35),t._uU(54,"Origine du lot"),t.qZA(),t.TgZ(55,"select",36),t._UZ(56,"option"),t.TgZ(57,"option",37),t._uU(58,"Terrain"),t.qZA(),t.TgZ(59,"option",38),t._uU(60,"Frigo \xc9tang-Sal\xe9"),t.qZA(),t.TgZ(61,"option",39),t._uU(62,"Frigo Bois de N\xe8fles"),t.qZA(),t.TgZ(63,"option",40),t._uU(64,"Autres :"),t.qZA()(),t.YNc(65,ht,2,1,"div",26),t.YNc(66,vt,1,0,"input",41),t.YNc(67,Tt,2,1,"div",26),t.qZA()(),t.TgZ(68,"h3"),t._uU(69,"Fruits"),t.qZA(),t.TgZ(70,"div",42)(71,"div",43)(72,"label",44),t._uU(73,"Poids"),t.qZA(),t._UZ(74,"input",45),t.YNc(75,Ct,3,2,"div",26),t.qZA(),t.TgZ(76,"div",43)(77,"label",46),t._uU(78,"Nombre"),t.qZA(),t._UZ(79,"input",47),t.YNc(80,At,3,2,"div",26),t.qZA()(),t.TgZ(81,"div",48)(82,"div",49)(83,"label",50),t._uU(84,"\xc9tat"),t.qZA(),t.TgZ(85,"div",51),t.YNc(86,yt,4,5,"div",52),t.qZA()()(),t.TgZ(87,"h3"),t._uU(88,"Graines"),t.qZA(),t.TgZ(89,"div",48)(90,"div",53)(91,"label",54),t._uU(92,"Poids total"),t.qZA(),t._UZ(93,"input",55),t.YNc(94,Nt,3,2,"div",26),t.qZA(),t.TgZ(95,"div",53)(96,"label",56),t._uU(97," Poids 100 graines "),t.qZA(),t._UZ(98,"input",57),t.YNc(99,Ut,2,1,"div",26),t.qZA(),t.TgZ(100,"div",53)(101,"label",58),t._uU(102," Poids 1000 graines "),t.qZA(),t._UZ(103,"input",59),t.YNc(104,St,2,1,"div",26),t.qZA()(),t.TgZ(105,"div",48)(106,"div",53)(107,"label",60),t._uU(108," Nombre (estim\xe9) "),t.qZA(),t._UZ(109,"input",61),t.YNc(110,Qt,3,2,"div",26),t.qZA(),t.TgZ(111,"div",53)(112,"label",62),t._uU(113," Nombre (compt\xe9) "),t.qZA(),t._UZ(114,"input",63),t.YNc(115,Vt,3,2,"div",26),t.qZA()(),t.TgZ(116,"div",48)(117,"div",49)(118,"label",64),t._uU(119,"\xc9tat"),t.qZA(),t.TgZ(120,"div",51),t.YNc(121,Dt,4,5,"div",52),t.qZA()()(),t.TgZ(122,"div",48)(123,"div",53)(124,"label",65),t._uU(125," Poids de graines au rebut "),t.qZA(),t._UZ(126,"input",66),t.YNc(127,$t,3,2,"div",26),t.qZA(),t.TgZ(128,"div",53)(129,"label",67),t._uU(130," Nombre de graines au rebut "),t.qZA(),t._UZ(131,"input",68),t.YNc(132,Pt,3,2,"div",26),t.qZA()(),t.TgZ(133,"div",48)(134,"div",8)(135,"div",22)(136,"label",69),t._uU(137," Raison de la mise au rebut "),t.qZA(),t._UZ(138,"textarea",70),t.qZA()()(),t.TgZ(139,"div",48)(140,"div",71)(141,"div",22)(142,"label",72),t._uU(143," Dur\xe9e du tri et nettoyage"),t.qZA(),t._UZ(144,"input",73),t.qZA(),t.YNc(145,Ht,3,2,"div",26),t.qZA()(),t.TgZ(146,"button",74),t._uU(147,"Enregistrer"),t.qZA()()()(),t._UZ(148,"app-spinner")),2&e){const s=t.MAs(14);t.xp6(3),t.Q6J("routerLink",t.DdM(27,Kt)),t.xp6(9),t.Q6J("ngIf",null==i.triForm.id?null:i.triForm.id.value)("ngIfElse",s),t.xp6(4),t.Q6J("disabled",!i.data.tri.id),t.xp6(5),t.Q6J("formGroup",i.triForm.fg),t.xp6(11),t.Q6J("selectedTaxon",i.data.selectedTaxon),t.xp6(2),t.Q6J("ngIf",(null==i.triForm.nom_botanique?null:i.triForm.nom_botanique.invalid)&&((null==i.triForm.nom_botanique?null:i.triForm.nom_botanique.dirty)||(null==i.triForm.nom_botanique?null:i.triForm.nom_botanique.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.num_accession?null:i.triForm.num_accession.invalid)&&((null==i.triForm.num_accession?null:i.triForm.num_accession.dirty)||(null==i.triForm.num_accession?null:i.triForm.num_accession.touched))),t.xp6(6),t.Q6J("ngIf",(null==i.triForm.tri_date?null:i.triForm.tri_date.invalid)&&((null==i.triForm.tri_date?null:i.triForm.tri_date.dirty)||(null==i.triForm.tri_date?null:i.triForm.tri_date.touched))),t.xp6(5),t.Q6J("formInput",i.triForm.agents)("selectedAgents",i.data.tri.agents),t.xp6(1),t.Q6J("ngIf",(null==i.triForm.agents?null:i.triForm.agents.invalid)&&((null==i.triForm.agents?null:i.triForm.agents.dirty)||(null==i.triForm.agents?null:i.triForm.agents.touched))),t.xp6(14),t.Q6J("ngIf",(null==i.triForm.tri_origin?null:i.triForm.tri_origin.invalid)&&((null==i.triForm.tri_origin?null:i.triForm.tri_origin.dirty)||(null==i.triForm.tri_origin?null:i.triForm.tri_origin.touched))),t.xp6(1),t.Q6J("ngIf","other"===i.triForm.tri_origin.value),t.xp6(1),t.Q6J("ngIf",(null==i.triForm.tri_origin_other?null:i.triForm.tri_origin_other.invalid)&&((null==i.triForm.tri_origin_other?null:i.triForm.tri_origin_other.dirty)||(null==i.triForm.tri_origin_other?null:i.triForm.tri_origin_other.touched))),t.xp6(8),t.Q6J("ngIf",(null==i.triForm.fruits_pds?null:i.triForm.fruits_pds.invalid)&&((null==i.triForm.fruits_pds?null:i.triForm.fruits_pds.dirty)||(null==i.triForm.fruits_pds?null:i.triForm.fruits_pds.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.fruits_nb?null:i.triForm.fruits_nb.invalid)&&((null==i.triForm.fruits_nb?null:i.triForm.fruits_nb.dirty)||(null==i.triForm.fruits_nb?null:i.triForm.fruits_nb.touched))),t.xp6(6),t.Q6J("ngForOf",i.triForm.data.triFruitsEtat),t.xp6(8),t.Q6J("ngIf",(null==i.triForm.graines_pds?null:i.triForm.graines_pds.invalid)&&((null==i.triForm.graines_pds?null:i.triForm.graines_pds.dirty)||(null==i.triForm.graines_pds?null:i.triForm.graines_pds.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.graines_100pds?null:i.triForm.graines_100pds.invalid)&&((null==i.triForm.graines_100pds?null:i.triForm.graines_100pds.dirty)||(null==i.triForm.graines_100pds?null:i.triForm.graines_100pds.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.graines_1000pds?null:i.triForm.graines_1000pds.invalid)&&((null==i.triForm.graines_1000pds?null:i.triForm.graines_1000pds.dirty)||(null==i.triForm.graines_1000pds?null:i.triForm.graines_1000pds.touched))),t.xp6(6),t.Q6J("ngIf",(null==i.triForm.graines_nb_estime?null:i.triForm.graines_nb_estime.invalid)&&((null==i.triForm.graines_nb_estime?null:i.triForm.graines_nb_estime.dirty)||(null==i.triForm.graines_nb_estime?null:i.triForm.graines_nb_estime.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.graines_nb?null:i.triForm.graines_nb.invalid)&&((null==i.triForm.graines_nb?null:i.triForm.graines_nb.dirty)||(null==i.triForm.graines_nb?null:i.triForm.graines_nb.touched))),t.xp6(6),t.Q6J("ngForOf",i.triForm.data.triGrainesEtat),t.xp6(6),t.Q6J("ngIf",(null==i.triForm.graines_trash_pds?null:i.triForm.graines_trash_pds.invalid)&&((null==i.triForm.graines_trash_pds?null:i.triForm.graines_trash_pds.dirty)||(null==i.triForm.graines_trash_pds?null:i.triForm.graines_trash_pds.touched))),t.xp6(5),t.Q6J("ngIf",(null==i.triForm.graines_trash_nb?null:i.triForm.graines_trash_nb.invalid)&&((null==i.triForm.graines_trash_nb?null:i.triForm.graines_trash_nb.dirty)||(null==i.triForm.graines_trash_nb?null:i.triForm.graines_trash_nb.touched))),t.xp6(13),t.Q6J("ngIf",(null==i.triForm.tri_duree?null:i.triForm.tri_duree.invalid)&&((null==i.triForm.tri_duree?null:i.triForm.tri_duree.dirty)||(null==i.triForm.tri_duree?null:i.triForm.tri_duree.touched)))}},directives:[g.yS,m.O5,o._Y,o.JL,o.sg,X,o.Fj,o.JJ,o.u,o.Q7,o.c5,o.wO,nt,o.EJ,o.YN,o.Kr,o.wV,m.sg,o.CE,T.O],styles:["[_nghost-%COMP%]{display:block;position:relative}"],changeDetection:0}),r})();var A=a(7329),Wt=a(1983);class F{constructor(n){this.items=[],this.metadata=new Wt.a,Object.assign(this,n)}}var y=a(1597),Q=a(850),Z=a(5382),te=a(2986);const ee=(0,Z.ZF)("tris"),ie=(0,Z.P1)(ee,r=>r.filters);class re{constructor(n){this.fb=n,this.fgObject={nom_botanique:[""],ordering_column:[""],ordering_direction:[""],limit:[25],limit_start:[0]},this.updateValidators=e=>{null!==e&&this.fg.updateValueAndValidity()},this.fg=this.fb.group(this.fgObject)}patchValue(n){var e;for(let[i,s]of Object.entries(n))this.fg.get(i)&&(null===(e=this.fg.get(i))||void 0===e||e.setValue(s))}get nom_botanique(){return this.fg.get("nom_botanique")}get ordering_column(){return this.fg.get("ordering_column")}get ordering_direction(){return this.fg.get("ordering_direction")}get limit(){return this.fg.get("limit")}get limit_start(){return this.fg.get("limit_start")}}function ne(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",1)(2,"h4",17),t._uU(3," Filtres "),t.TgZ(4,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().onReset()}),t.TgZ(5,"small"),t._uU(6,"Effacer les filtres"),t.qZA()()(),t.TgZ(7,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleFilters()}),t.TgZ(8,"span",13),t._uU(9," cancel "),t.qZA()()(),t.TgZ(10,"div",20)(11,"div",21)(12,"div",22)(13,"div",23)(14,"div")(15,"label",24),t._uU(16,"Nom botanique"),t.qZA()(),t.TgZ(17,"div",25),t._UZ(18,"input",26),t.qZA()()()()(),t.TgZ(19,"div",27)(20,"button",28),t._uU(21," Filtrer "),t.qZA()()()}}let se=(()=>{class r{constructor(e,i,s,l,u){this.cdRef=e,this.element=i,this.fb=s,this.renderer=l,this.store=u,this.filtersChanged=new t.vpe,this.data={states:{filtersVisible:!1,countFilters:0}},this.onComponentDestroy$=new f.xQ,this.initData=()=>{this.store.select(ie).pipe((0,te.q)(1)).subscribe(d=>{this.filtersForm.patchValue(d),setTimeout(()=>{this.onSubmit()})})},this.filtersForm=new re(this.fb)}ngOnInit(){}ngAfterViewInit(){this.initData(),this.filtersForm.fg.valueChanges.pipe((0,q.R)(this.onComponentDestroy$)).subscribe(e=>{let i=this.filtersForm.fg.value,s=0;for(let l in i)["fulltext","limit"].includes(l)||""!==i[l]&&null!=i[l]&&(s+=1);this.data.states.countFilters=s,this.cdRef.markForCheck()}),this.unlistenDocumentClick$=this.renderer.listen(document,"click",e=>{this.onClickOutside(e)})}ngOnDestroy(){this.onComponentDestroy$.next(),this.onComponentDestroy$.complete()}toggleFilters(e=null){this.data.states.filtersVisible=!this.data.states.filtersVisible,this.cdRef.markForCheck(),null==e||e.stopPropagation()}onReset(){this.filtersForm.nom_botanique.reset(),this.onSubmit()}onSubmit(){this.filtersChanged.emit(this.filtersForm.fg.value),this.store.dispatch((0,Q.J)(this.filtersForm.fg.value))}onClickOutside(e){this.element.nativeElement.querySelector(".trisFiltersContainer")&&!this.element.nativeElement.querySelector(".trisFiltersContainer").contains(e.target)&&this.toggleFilters(e)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(o.qu),t.Y36(t.Qsj),t.Y36(Z.yh))},r.\u0275cmp=t.Xpm({type:r,selectors:[["tris-filters"]],outputs:{filtersChanged:"filtersChanged"},decls:25,vars:3,consts:[["name","trisFiltersForm",3,"formGroup","ngSubmit"],[1,"card-header"],[1,"container"],[1,"row"],[1,"col"],[1,"col-auto"],["aria-label","Nombre de lignes","formControlName","limit",1,"form-select","form-select-sm",3,"change"],["value","5"],["value","10"],["value","25"],["value","50"],["value",""],["type","button","aria-expanded","false",1,"btn","btn-sm","btn-white",3,"click"],[1,"material-symbols-outlined"],[1,"badge","bg-primary","ms-1"],["class","card trisFiltersContainer","style","position: absolute; inset: 0px 1rem auto 1rem; transform: translate(0px, 64px);",4,"ngIf"],[1,"card","trisFiltersContainer",2,"position","absolute","inset","0px 1rem auto 1rem","transform","translate(0px, 64px)"],[1,"card-header-title",2,"margin","0"],["type","button",1,"btn","btn-sm","btn-link","text-reset",3,"click"],["type","button",1,"ms-auto","btn","btn-sm","btn-link","text-reset",3,"click"],[1,"card-body"],[1,"list-group","list-group-flush","mt-n4","mb-4"],[1,"list-group-item"],[1,"d-flex","align-items-center"],["for","stagiaireLicence"],[1,"ms-2"],["type","text","id","nom_botanique","formControlName","nom_botanique",1,"form-control"],[1,"card-footer","d-flex","align-items-center"],["type","submit",1,"btn","btn-primary"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"div",4),t.TgZ(5,"div",5)(6,"select",6),t.NdJ("change",function(){return i.onSubmit()}),t.TgZ(7,"option",7),t._uU(8,"5"),t.qZA(),t.TgZ(9,"option",8),t._uU(10,"10"),t.qZA(),t.TgZ(11,"option",9),t._uU(12,"25"),t.qZA(),t.TgZ(13,"option",10),t._uU(14,"50"),t.qZA(),t.TgZ(15,"option",11),t._uU(16,"illimite"),t.qZA()()(),t.TgZ(17,"div",5)(18,"button",12),t.NdJ("click",function(l){return i.toggleFilters(l)}),t.TgZ(19,"span",13),t._uU(20," filter_list "),t.qZA(),t._uU(21," Filtres "),t.TgZ(22,"span",14),t._uU(23),t.qZA()()()()()(),t.YNc(24,ne,22,0,"div",15),t.qZA()),2&e&&(t.Q6J("formGroup",i.filtersForm.fg),t.xp6(23),t.Oqu(i.data.states.countFilters),t.xp6(1),t.Q6J("ngIf",i.data.states.filtersVisible))},directives:[o._Y,o.JL,o.sg,o.EJ,o.JJ,o.u,o.YN,o.Kr,m.O5,o.Fj],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),r})();const oe=function(r){return{id:r}},le=function(r){return["/tris/tri-edit",r]};function ae(r,n){if(1&r&&(t.TgZ(0,"tr"),t._UZ(1,"td",12),t.TgZ(2,"td",13)(3,"a",14)(4,"span"),t._uU(5),t.qZA()()(),t.TgZ(6,"td",15)(7,"span"),t._uU(8),t.ALo(9,"date"),t.qZA()(),t.TgZ(10,"td",16)(11,"span"),t._uU(12),t.qZA()(),t.TgZ(13,"td",17)(14,"span"),t._uU(15),t.qZA()()()),2&r){const e=n.$implicit;t.xp6(3),t.Q6J("routerLink",t.VKq(10,le,t.VKq(8,oe,e.id))),t.xp6(2),t.Oqu(e.nom_botanique),t.xp6(3),t.Oqu(t.xi3(9,5,e.tri_date,"dd/MM/yyyy")),t.xp6(4),t.Oqu(e.graines_nb),t.xp6(3),t.Oqu(e.graines_pds)}}function ue(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"li",18)(1,"a",19),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().onPaginate(l.num)}),t._UZ(2,"span",20),t.qZA()()}if(2&r){const e=n.$implicit;t.Q6J("ngClass",e.liClass),t.xp6(1),t.Q6J("ngClass",e.aClass),t.xp6(1),t.Q6J("innerHtml",e.label,t.oJD)}}let de=(()=>{class r{constructor(e){this.store=e,this.filtersChanged=new t.vpe,this.data={filters:new A.j,tris:new F,pagination:[]}}set tris(e){this.data.tris=new F(e),this.makePagination()}ngOnInit(){}onFiltersChanged(e){this.data.filters=Object.assign(Object.assign({},this.data.filters),e),this.filtersChanged.emit(e)}onSort(e){let i={ordering_column:e,ordering_direction:""};if(this.data.filters.ordering_column===e)switch(this.data.filters.ordering_direction){case"ASC":i.ordering_direction="DESC";break;case"DESC":i.ordering_direction="",i.ordering_column="";break;default:i.ordering_direction="ASC"}else i.ordering_direction="ASC";this.onFiltersChanged(i)}onPaginate(e){let i={limit:this.data.filters.limit,limit_start:e*this.data.filters.limit};this.onFiltersChanged(i),this.store.dispatch((0,Q.J)(Object.assign(Object.assign({},this.data.filters),i)))}makePagination(){this.data.pagination=[];let e=Math.ceil(this.data.tris.metadata.totalItems/this.data.filters.limit);for(let l=0;l<e;l++){let u=new y.T({num:l});u.label=l+1+"",u.num==Math.floor(this.data.filters.limit_start/this.data.filters.limit)&&(u.liClass+=" active"),this.data.pagination.push(u)}let i=new y.T({label:"&laquo;"});i.aClass=0==Math.floor(this.data.filters.limit_start/this.data.filters.limit)?"disabled":"",i.ariaLabel="Pr\xe9c\xe9dent",this.data.pagination.unshift(i);let s=new y.T({num:Math.floor(this.data.tris.metadata.totalItems/this.data.filters.limit),label:"&raquo;"});s.aClass=this.data.tris.metadata.totalItems-this.data.filters.limit_start*this.data.filters.limit>0?"":"disabled",s.ariaLabel="Suivant",this.data.pagination.push(s)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(Z.yh))},r.\u0275cmp=t.Xpm({type:r,selectors:[["tris-table"]],inputs:{tris:"tris"},outputs:{filtersChanged:"filtersChanged"},decls:24,vars:2,consts:[["id","trisList",1,"card"],[3,"filtersChanged"],[1,"table-responsive"],[1,"tris-table","table","table-sm","table-hover","table-nowrap","card-table","mb-2"],["data-sort","",1,"nom_botanique","list-sort","text-muted",3,"routerLink","click"],["data-sort","",1,"list-sort","text-muted",3,"routerLink","click"],[1,"d-none","d-sm-table-cell"],[1,"text-muted"],[4,"ngFor","ngForOf"],["aria-label","tris pagination",1,"pe-4","d-flex","justify-content-end"],[1,"pagination","pagination-sm"],["class","page-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"td-check"],[1,"nom_botanique"],[1,"item-name","text-reset",3,"routerLink"],[1,"tri_date"],[1,"graines_nb","d-none","d-sm-table-cell"],[1,"graines_pds","d-none","d-sm-table-cell"],[1,"page-item",3,"ngClass"],[1,"page-link",3,"routerLink","ngClass","click"],["aria-hidden","true",3,"innerHtml"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"tris-filters",1),t.NdJ("filtersChanged",function(l){return i.onFiltersChanged(l)}),t.qZA(),t.TgZ(2,"div",2)(3,"table",3)(4,"thead")(5,"tr"),t._UZ(6,"th"),t.TgZ(7,"th")(8,"a",4),t.NdJ("click",function(){return i.onSort("nom_botanique")}),t._uU(9," Nom botanique "),t.qZA()(),t.TgZ(10,"th")(11,"a",5),t.NdJ("click",function(){return i.onSort("tri_date")}),t._uU(12," Date de tri "),t.qZA()(),t.TgZ(13,"th",6)(14,"span",7),t._uU(15," Nombre "),t.qZA()(),t.TgZ(16,"th",6)(17,"span",7),t._uU(18," Poids "),t.qZA()()()(),t.TgZ(19,"tbody"),t.YNc(20,ae,16,12,"tr",8),t.qZA()(),t.TgZ(21,"nav",9)(22,"ul",10),t.YNc(23,ue,3,3,"li",11),t.qZA()()()()),2&e&&(t.xp6(20),t.Q6J("ngForOf",i.data.tris.items),t.xp6(3),t.Q6J("ngForOf",i.data.pagination))},directives:[se,g.yS,m.sg,m.mk],pipes:[m.uU],styles:["[_nghost-%COMP%]{display:block}","@media (max-width: 575px){[_nghost-%COMP%]   .tris-table[_ngcontent-%COMP%]   td.nom_botanique[_ngcontent-%COMP%]{max-width:200px;width:200px}[_nghost-%COMP%]   .tris-table[_ngcontent-%COMP%]   td.nom_botanique[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;text-overflow:ellipsis;overflow:hidden}}"],changeDetection:0}),r})();const me=function(){return["/tris/tri-edit"]},ce=[{path:"",component:(()=>{class r{constructor(e,i){this.cdRef=e,this.client=i,this.data={tris:new F,filters:new A.j},this.onComponentDestroy$=new f.xQ,this.index=(s=new A.j)=>{this.spinner.show(),this.client.index(s).pipe((0,h.x)(()=>this.spinner.hide())).subscribe(l=>{this.data.tris=new F(l),this.cdRef.markForCheck()})}}ngOnInit(){}ngOnDestroy(){this.onComponentDestroy$.next(),this.onComponentDestroy$.complete()}onFiltersChanged(e){this.index(e)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(t.sBO),t.Y36(N))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-tris"]],viewQuery:function(e,i){if(1&e&&t.Gf(T.O,5),2&e){let s;t.iGM(s=t.CRH())&&(i.spinner=s.first)}},decls:16,vars:3,consts:[["aria-label","breadcrumb"],[1,"breadcrumb","text-upper-small"],[1,"breadcrumb-item"],[1,"header"],[1,"header-body"],[1,"row","align-items-center"],[1,"col"],[1,"header-title","text-truncate"],[1,"col-auto"],["type","button","label","Add",1,"btn","btn-primary","ms-2","d-flex",3,"routerLink"],[1,"material-symbols-outlined"],[3,"tris","filtersChanged"]],template:function(e,i){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2),t._uU(3,"Tris"),t.qZA()()(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"h1",7),t._uU(9," Liste "),t.qZA()(),t.TgZ(10,"div",8)(11,"button",9)(12,"span",10),t._uU(13," add "),t.qZA()()()()()(),t.TgZ(14,"tris-table",11),t.NdJ("filtersChanged",function(l){return i.onFiltersChanged(l)}),t.qZA(),t._UZ(15,"app-spinner")),2&e&&(t.xp6(11),t.Q6J("routerLink",t.DdM(2,me)),t.xp6(3),t.Q6J("tris",i.data.tris))},directives:[g.rH,de,T.O],styles:[""],changeDetection:0}),r})()},{path:"tri-edit",component:Xt}];let _e=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[g.Bz.forChild(ce)],g.Bz]}),r})(),ge=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[m.ez,o.u5]]}),r})(),pe=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[O],imports:[[m.ez,o.u5]]}),r})();var fe=a(1310);let he=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[m.ez,o.u5,o.UX,_e,ge,pe,fe.F]]}),r})()}}]);